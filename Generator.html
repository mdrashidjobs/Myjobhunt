<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Job Hunt Index Generator</title>
<style>
body { font-family: Arial, sans-serif; background:#f5f5f5; margin:0; padding:0;}
h1 { text-align:center; color:#0056b3; margin-top:20px;}
textarea { width:95%; height:200px; margin:20px auto; display:block; font-family:monospace; font-size:14px;}
button { display:block; margin:10px auto; padding:10px 20px; font-size:16px; background:#0056b3; color:#fff; border:none; border-radius:5px; cursor:pointer;}
#tabs { display:flex; justify-content:center; flex-wrap:wrap; margin:10px;}
.tab-btn { padding:10px 15px; margin:5px; background:#007bff; color:#fff; border:none; border-radius:5px; cursor:pointer;}
.tab-btn.active { background:#003f7f;}
.tab-content { display:none; padding:20px; max-width:900px; margin:0 auto; background:#fff; border-radius:5px; box-shadow:0 0 5px rgba(0,0,0,0.2);}
.tab-content.active { display:block;}
.separator { border-top:2px solid #0056b3; margin:10px 0;}
.adsense { text-align:center; margin:20px 0;}
</style>

<!-- Google AdSense Meta Tag -->
<meta name="google-adsense-account" content="ca-pub-3037151964199001">

<!-- Google AdSense Script -->
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3037151964199001"
     crossorigin="anonymous"></script>

</head>
<body>

<h1>MY JOB HUNT</h1>
<div class="separator"></div>
<p style="text-align:center;">Date: <span id="todayDate"></span></p>
<div class="separator"></div>

<textarea id="rawJobs" placeholder="Paste your WhatsApp job ads here..."></textarea>
<button id="generateBtn">Generate Index & Download</button>

<div id="tabs"></div>
<div id="tabContents"></div>

<script>
// Set today's date
document.getElementById('todayDate').innerText = new Date().toLocaleDateString('en-GB', {day:'2-digit', month:'long', year:'numeric'});

// Simple category mapping based on job title keywords
const categoryKeywords = {
    "Sales": ["Sales", "Marketing", "Salesperson", "Sales Coordinator", "Business Development"],
    "Admin/HR": ["HR", "Coordinator", "Assistant", "Secretary", "Receptionist", "Admin"],
    "Engineering/Technical": ["Engineer", "Mechanical", "Electrical", "Project Control", "Planning"],
    "Kitchen/Hotel": ["Cook", "Chef", "Kitchen", "Waitress", "Florist"],
    "Others": []
};

function assignCategory(title) {
    for (let cat in categoryKeywords) {
        for (let kw of categoryKeywords[cat]) {
            if (title.toLowerCase().includes(kw.toLowerCase())) return cat;
        }
    }
    return "Others";
}

document.getElementById('generateBtn').addEventListener('click', () => {
    const raw = document.getElementById('rawJobs').value.trim();
    if (!raw) { alert("Please paste WhatsApp jobs first!"); return; }

    const jobs = raw.split(/\n\n+/); // Separate jobs by double newlines
    const categorized = {};

    jobs.forEach(job => {
        const titleMatch = job.match(/ðŸ“Œ\s*(.+)/);
        const title = titleMatch ? titleMatch[1] : "Unknown";
        const category = assignCategory(title);
        if (!categorized[category]) categorized[category] = [];
        categorized[category].push(job);
    });

    // Create tabs
    const tabContainer = document.createElement('div');
    tabContainer.id = 'tabs';
    let tabButtons = '';
    let tabContents = '';
    let first = true;

    for (let cat in categorized) {
        const btnClass = first ? "tab-btn active" : "tab-btn";
        tabButtons += `<button class="${btnClass}" onclick="openTab('${cat}')">${cat} (${categorized[cat].length})</button>`;
        let jobsHtml = categorized[cat].map(job => `<div class="job"><p>${job.replace(/\n/g,'<br>')}</p><div class="separator"></div></div>`).join('');
        // Insert AdSense middle
        if (categorized[cat].length > 3) {
            const mid = Math.floor(categorized[cat].length/2);
            jobsHtml = jobsHtml.split('</div><div class="separator"></div>')[0] + 
                        `<div class="adsense"><ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-3037151964199001"
                            data-ad-slot="1234567890"
                            data-ad-format="auto"
                            data-full-width-responsive="true"></ins></div>` +
                        jobsHtml;
        }

        const contentClass = first ? "tab-content active" : "tab-content";
        tabContents += `<div id="${cat}" class="${contentClass}"><div class="adsense"><ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-3037151964199001"
                            data-ad-slot="1234567890"
                            data-ad-format="auto"
                            data-full-width-responsive="true"></ins></div>` +
                        jobsHtml +
                        `<div class="adsense"><ins class="adsbygoogle"
                            style="display:block"
                            data-ad-client="ca-pub-3037151964199001"
                            data-ad-slot="1234567890"
                            data-ad-format="auto"
                            data-full-width-responsive="true"></ins></div></div>`;
        first = false;
    }

    const indexHtml = `
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MY JOB HUNT</title>
<meta name="google-adsense-account" content="ca-pub-3037151964199001">
<script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-3037151964199001" crossorigin="anonymous"></script>
<style>
body { font-family: Arial, sans-serif; background:#f5f5f5; margin:0; padding:0;}
h1 { text-align:center; color:#0056b3; margin-top:20px;}
.separator { border-top:2px solid #0056b3; margin:10px 0;}
#tabs { display:flex; justify-content:center; flex-wrap:wrap; margin:10px;}
.tab-btn { padding:10px 15px; margin:5px; background:#007bff; color:#fff; border:none; border-radius:5px; cursor:pointer;}
.tab-btn.active { background:#003f7f;}
.tab-content { display:none; padding:20px; max-width:900px; margin:0 auto; background:#fff; border-radius:5px; box-shadow:0 0 5px rgba(0,0,0,0.2);}
.tab-content.active { display:block;}
.adsense { text-align:center; margin:20px 0;}
.job p { margin:5px 0;}
</style>
</head>
<body>
<h1>MY JOB HUNT</h1>
<div class="separator"></div>
<p style="text-align:center;">Date: ${new Date().toLocaleDateString('en-GB', {day:'2-digit', month:'long', year:'numeric'})}</p>
<div class="separator"></div>
<div id="tabs">${tabButtons}</div>
<div id="tabContents">${tabContents}</div>
<script>
function openTab(cat) {
    document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    document.getElementById(cat).classList.add('active');
    event.currentTarget.classList.add('active');
    (adsbygoogle = window.adsbygoogle || []).push({});
}
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</body>
</html>
`;

    // Trigger download
    const blob = new Blob([indexHtml], {type:'text/html'});
    const a = document.createElement('a');
    a.href = URL.createObjectURL(blob);
    a.download = 'job_index.html';
    a.click();
});
</script>
</body>
</html>
