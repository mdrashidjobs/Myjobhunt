<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Job Parser by Category</title>
<style>
body { font-family: Arial, sans-serif; margin: 20px; background: #f9f9f9; }
h2 { margin-top: 30px; }
textarea { width: 100%; height: 150px; font-family: monospace; font-size: 14px; padding: 10px; margin-bottom: 10px; }
button { padding: 10px 20px; font-size: 16px; cursor: pointer; margin-top: 20px; }
.category-container { margin-bottom: 30px; }
</style>
</head>
<body>

<h1>ðŸ“Œ Job Parser (Category-wise)</h1>
<p>Paste jobs under each category. One job per line. Click <b>Save JSON</b> to download updated <code>jobs.json</code>.</p>

<div id="categoriesContainer"></div>

<button id="save">Save JSON</button>

<script>
const categories = ["Admin", "Finance", "IT", "Engineering", "Safety", "Healthcare", "Sales", "Drivers"];
const container = document.getElementById("categoriesContainer");

// Create a textarea for each category
categories.forEach(cat => {
  const div = document.createElement("div");
  div.className = "category-container";
  div.innerHTML = `<h2>${cat}</h2><textarea id="cat-${cat}" placeholder="Paste ${cat} jobs here..."></textarea>`;
  container.appendChild(div);
});

// Save button click
document.getElementById("save").addEventListener("click", function() {
  const today = new Date().toISOString().split("T")[0];

  // Fetch old jobs.json if exists
  fetch("jobs.json")
    .then(r => r.json())
    .catch(() => ({}))
    .then(data => {
      if (!data[today]) data[today] = {};

      categories.forEach(cat => {
        let text = document.getElementById(`cat-${cat}`).value.trim();
        let jobsArray = text.split("\n").filter(line => line.trim() !== "");
        if (!data[today][cat]) data[today][cat] = [];
        data[today][cat] = data[today][cat].concat(jobsArray);
      });

      // Download JSON
      const blob = new Blob([JSON.stringify(data, null, 2)], {type: "application/json"});
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "jobs.json";
      a.click();
      URL.revokeObjectURL(url);

      alert("âœ… jobs.json downloaded successfully!");
    });
});
</script>

</body>
</html>
