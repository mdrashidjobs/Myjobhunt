<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Job Index Generator</title>
<style>
body { font-family: Arial, sans-serif; background: #f4f4f9; padding: 20px; }
h2 { text-align:center; color:#333; }
textarea { width: 100%; height: 400px; font-family: monospace; margin-bottom: 20px; border-radius:8px; border:1px solid #ccc; padding:10px; }
button { padding: 10px 20px; font-size: 16px; cursor:pointer; margin-right: 10px; border:none; border-radius:5px; background:#3498db; color:white; }
button:hover { background:#2980b9; }
</style>
</head>
<body>

<h2>WhatsApp Job Index Generator</h2>
<p>Paste your raw WhatsApp jobs below and click ‚ÄúGenerate & Download Index‚Äù</p>
<textarea id="rawJobs" placeholder="Paste raw WhatsApp jobs here..."></textarea><br>
<button onclick="generateIndex()">Generate & Download Index</button>

<script>
function escapeHTML(text){
    return text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");
}

function generateIndex(){
    const raw = document.getElementById('rawJobs').value.trim();
    if(!raw){ alert("Please paste the raw jobs first."); return; }

    const jobs = raw.split(/‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ú¶‚úø‚ú¶‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ/).filter(j=>j.trim()!=="");

    let categories = [];
    let categorizedJobs = {};
    jobs.forEach(job=>{
        const firstLineMatch = job.match(/üìå\s*(.*)/);
        let cat = firstLineMatch ? firstLineMatch[1].split('‚Äì')[0].trim() : "Misc";
        if(!categories.includes(cat)) categories.push(cat);
        if(!categorizedJobs[cat]) categorizedJobs[cat] = [];
        categorizedJobs[cat].push(job.trim());
    });

    let tabsHTML = categories.map((c,i)=>`<button class="tablink" onclick="openTab(event, 'tab${i}')">${c}</button>`).join(" ");

    let contentsHTML = categories.map((c,i)=>{
        let jobsHTML = categorizedJobs[c].map(j=>`<pre>${escapeHTML(j)}</pre>`).join("<hr>");
        return `<div id="tab${i}" class="tabcontent" style="display:${i===0?'block':'none'}">${jobsHTML}</div>`;
    }).join("");

    const today = new Date();
    const dateStr = today.toLocaleDateString('en-GB', {day:'2-digit', month:'long', year:'numeric'});

    const indexHTML = `
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MY JOB HUNT</title>
<style>
body { font-family: Arial, sans-serif; margin:20px; background:#f4f4f9; }
h1, h2 { text-align:center; color:#2c3e50; }
button.tablink { padding:10px 15px; margin:5px; cursor:pointer; background:#3498db; color:white; border:none; border-radius:5px; font-weight:bold; }
button.tablink:hover { background:#2980b9; }
div.tabcontent { display:none; padding:15px; border-top:1px solid #ccc; background:white; border-radius:5px; margin-top:10px; }
pre { white-space: pre-wrap; word-wrap: break-word; background:#ecf0f1; padding:10px; border-radius:5px; }
hr { border:none; border-top:1px dashed #bbb; margin:10px 0; }
</style>
</head>
<body>

<h1>MY JOB HUNT</h1>
<hr>
<h2>${dateStr}</h2>
<hr>

<div style="text-align:center;">${tabsHTML}</div>

${contentsHTML}

<script>
function openTab(evt, tabName){
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");
    for(i=0;i<tabcontent.length;i++){ tabcontent[i].style.display="none"; }
    tablinks = document.getElementsByClassName("tablink");
    for(i=0;i<tablinks.length;i++){ tablinks[i].style.background="#3498db"; }
    document.getElementById(tabName).style.display="block";
    evt.currentTarget.style.background="#2980b9";
}
</script>

</body>
</html>
`;

    const blob = new Blob([indexHTML], {type:'text/html'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'index.html';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
}
</script>

</body>
</html>
